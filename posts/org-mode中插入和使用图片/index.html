<!DOCTYPE html>
<html lang="en">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.111.3">



<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon-16x16.png" />
<link rel="manifest" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/site.webmanifest" />
<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/safari-pinned-tab.svg" color="#8aa2d3" />
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon.ico" />
<meta name="theme-color" content="#ffffff" />


<title>org mode中插入和使用图片 - hllu&#39;s blog</title>


<meta name="author" content="[luhailong]" />


<meta name="description" content="A minimal Hugo theme with nice theme color." />


<meta name="keywords" content="picture, image, org, download, yasnippet" />


<meta property="og:title" content="org mode中插入和使用图片" />
<meta name="twitter:title" content="org mode中插入和使用图片" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hllu.github.io/posts/org-mode%E4%B8%AD%E6%8F%92%E5%85%A5%E5%92%8C%E4%BD%BF%E7%94%A8%E5%9B%BE%E7%89%87/" /><meta property="og:description" content="orgmode有各种各样的好处，主要是文本折叠和缩进的功能实在太好用，gtd也功 能很强大。无论是用于hugo编辑工具还是作为笔记的主力，都是很好的实践。 但有一个问题，是emacs和org的弱项-图片处" />
<meta name="twitter:description" content="orgmode有各种各样的好处，主要是文本折叠和缩进的功能实在太好用，gtd也功 能很强大。无论是用于hugo编辑工具还是作为笔记的主力，都是很好的实践。 但有一个问题，是emacs和org的弱项-图片处" /><meta property="og:image" content="https://hllu.github.io/img/og.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://hllu.github.io/img/og.png" /><meta property="article:published_time" content="2023-04-25T15:08:00+08:00" /><meta property="article:modified_time" content="2023-04-25T15:08:00+08:00" />


<style>
    @media (prefers-color-scheme: dark) {
        body[data-theme='auto'] img {
            filter: brightness(60%);
        }
    }

    body[data-theme='dark'] img {
        filter: brightness(60%);
    }
</style>



<link rel="stylesheet" href="https://hllu.github.io/assets/css/fuji.min.css" />





</head>

<body data-theme="auto">
    <script data-cfasync="false">
  
  var fujiThemeData = localStorage.getItem('fuji_data-theme');
  
  if (!fujiThemeData) {
    localStorage.setItem('fuji_data-theme', 'auto');
  } else {
    
    if (fujiThemeData !== 'auto') {
      document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
    }
  }
</script>
    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://hllu.github.io">hllu&#39;s blog</a>
            
            <span class="title-sub">hllu 的个人空间.</span>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://hllu.github.io/posts/org-mode%E4%B8%AD%E6%8F%92%E5%85%A5%E5%92%8C%E4%BD%BF%E7%94%A8%E5%9B%BE%E7%89%87/">org mode中插入和使用图片</a>
    </h2>
    <div class="post-item post-meta">
        <span><i class="iconfont icon-today-sharp"></i>&nbsp;2023-04-25</span>

<span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;1180 words</span>

<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href="/tags/picture">picture</a>&nbsp;<a href="/tags/image">image</a>&nbsp;<a href="/tags/org">org</a>&nbsp;<a href="/tags/download">download</a>&nbsp;<a href="/tags/yasnippet">yasnippet</a>&nbsp;</span>

    </div>
    
    <div class="post-content markdown-body">
        <p>orgmode有各种各样的好处，主要是文本折叠和缩进的功能实在太好用，gtd也功
能很强大。无论是用于hugo编辑工具还是作为笔记的主力，都是很好的实践。
但有一个问题，是emacs和org的弱项-图片处理。</p>
<p>在word等所见即所得的编辑工具中，插入图片可以很顺利的完成。而要在org文
档中插入一个图片，就麻烦很多。首先需要下载图片到一个特定的目录，插入图
片的时候，还需要用链接的方式把目录打出来。显示也不直观，往往在生成pdf
文档后，才发现图片过大或者过小，需要调整。随着时间的推移，org文档依赖
的图片也会增删改，导致文档的图片丢失。</p>
<p>但emacs和org有高度可定制性，通过搜索资料，找到了几乎完美的解决办法。</p>
<h2 id="org-download">org-download</h2>
<p>它可以现实以下功能：</p>
<ul>
<li>通过鼠标拖拽图片到emacs里，实现图片插入</li>
<li>通过绑定的快捷键激活外部截屏工具，以鼠标选定截屏区域，选好后直接插入
截图</li>
</ul>
<h3 id="安装">安装</h3>
<p>在emacs的emlp库中找到后，i选择安装，然后x执行就可以。</p>
<h3 id="配置">配置</h3>
<ul>
<li>官网的配置</li>
</ul>
<!--listend-->
<pre><code class="language-lisp">(require 'org-download)
(add-hook 'dired-mode-hook 'org-download-enable)
</code></pre>
<p>上面的配置仅能实现鼠标拖拽插入图片的功能，</p>
<ul>
<li>我的配置,其中定义annotate这个函数是为了避免每次截图都显示图片的一些注</li>
</ul>
<p>释信息。</p>
<pre><code class="language-lisp">(require 'org-download)
(add-hook 'dired-mode-hook 'org-download-enable)
(setq org-download-annotate-function (lambda (_link) &quot;&quot;))
</code></pre>
<ul>
<li>通过配置模式生成的配置
<pre><code class="language-lisp">(custom-set-variables
;; custom-set-variables was added by Custom.
;; If you edit it by hand, you could mess it up, so be careful.
;; Your init file should contain only one such instance.
;; If there is more than one, they won't work right.
'(org-agenda-files
  '(&quot;~/.todos/journal.org&quot; &quot;~/.todos/gtd.org&quot; &quot;~/.todos/work.org&quot;))
'(org-download-screenshot-method &quot;screencapture -i %s&quot;)
'(package-selected-packages
  '(org-download yasnippet ox-hugo openwith elpy magit magit-gerrit magithub)))
</code></pre>
</li>
</ul>
<p>org-download默认依赖的命令行截屏工具如下：</p>
<ul>
<li>Windows：imagemagick/convert；</li>
<li>Linux：gnome-screenshot, scrot, gm, xclip；</li>
<li>MAC：screencapture</li>
</ul>
<p>通过以上配置，就可以在mac上，配置图片截屏工具使用screencapture,实现截
屏图片快捷插入，也可以拖砖插入。</p>
<p>截图保存的图片名称：时间戳+截屏软件名称.png</p>
<p>截图保存的图片路径：以org文档的最外层标题为目录名，保存的org文档的同级目录下，如果不存在则创建</p>
<p>截屏的命令是</p>
<pre><code class="language-bash">M-x -d-sc
</code></pre>
<p>也可以自己定义一个快捷键。</p>
<ul>
<li>网上的部分配置参考，因为不想装对use package的依赖，没有采用
<pre><code class="language-lisp">(use-package org-download
        :ensure t
        :bind (&quot;C-S-y&quot; . org-download-screenshot)
        :config
        (require 'org-download)
        (add-hook 'dired-mode-hook 'org-download-enable)
        )
</code></pre>
</li>
</ul>
<h2 id="inline-images">inline images</h2>
<p>org提供了一个功能，可以显示图片，在org文档中，如果图片还是没有显示，只
是显示了链接，可以切换到显示 inline image，快捷键是 C-c C-x C-v 。</p>
<h2 id="使用yasnippet定义图片显示格式宏">使用yasnippet定义图片显示格式宏</h2>
<p>插入的图片，有时候需要指定一些显示效果，比如，靠左，靠右，定义像素值，
定义图片显示比例等。org模式下，有各种对图片的显示控制参数，如下</p>
<pre><code class="language-text">#+CAPTION: name
#+ATTR_HTML: :title tille1 :align centre
#+ATTR_HTML: :width 10% :height 20%
</code></pre>
<p>或者指定像素值</p>
<pre><code class="language-text">#+ATTR_ORG: :width  ~
#+ATTR_HTML:  :width  ~
</code></pre>
<p>这些值的指定，可以用yasnippet宏来实现，比如定一个picv的宏，在org模式中，
只要输入picv然后按tab键，就可以扩展成定义的格式，比较简便。</p>
<h2 id="使用效果">使用效果</h2>
<p><img class="img-zoomable" src="/ox-hugo/2023-04-25_15-40-32_screenshot.png" alt="" />

上图中，第二个链接是通过指定陪孩子，不显示图片注释信息。第三个链接是加
入了图片的显示定义参数。</p>

    </div>
</article>


<div class="license markdown-body">
    <blockquote>
        <p>Unless otherwise noted, the content of this site is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
               target="_blank">CC BY-NC-SA 4.0</a>.</p>
    </blockquote>
</div>



            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archives</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/search/">Search</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
            <li>
                <a href="https://github.com/hllu" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://space.bilibili.com" target="_blank"><span>bilibili</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
            <span>
                <a href="/tags/abbrev/">abbrev</a>
            </span>
            
            <span>
                <a href="/tags/beamer/">beamer</a>
            </span>
            
            <span>
                <a href="/tags/blog/">Blog</a>
            </span>
            
            <span>
                <a href="/tags/curl/">curl</a>
            </span>
            
            <span>
                <a href="/tags/download/">download</a>
            </span>
            
            <span>
                <a href="/tags/emacs/">emacs</a>
            </span>
            
            <span>
                <a href="/tags/http/">http</a>
            </span>
            
            <span>
                <a href="/tags/image/">image</a>
            </span>
            
            <span>
                <a href="/tags/odl/">odl</a>
            </span>
            
            <span>
                <a href="/tags/openstack/">openstack</a>
            </span>
            
            <span>
                <a href="/tags/org/">org</a>
            </span>
            
            <span>
                <a href="/tags/org-model/">org-model</a>
            </span>
            
            <span>
                <a href="/tags/picture/">picture</a>
            </span>
            
            <span>
                <a href="/tags/rpc/">rpc</a>
            </span>
            
            <span>
                <a href="/tags/skeleton/">skeleton</a>
            </span>
            
            <span>
                <a href="/tags/snippet/">snippet</a>
            </span>
            
            <span>
                <a href="/tags/ssh/">ssh</a>
            </span>
            
            <span>
                <a href="/tags/yasnippet/">yasnippet</a>
            </span>
            
            <span>
                <a href="/tags/%E5%8E%8B%E6%B5%8B/">压测</a>
            </span>
            
        </div>
    </div>
    <div class="sidebar-item sidebar-toc">
        <h3>Table of Contents</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#org-download">org-download</a>
      <ul>
        <li><a href="#安装">安装</a></li>
        <li><a href="#配置">配置</a></li>
      </ul>
    </li>
    <li><a href="#inline-images">inline images</a></li>
    <li><a href="#使用yasnippet定义图片显示格式宏">使用yasnippet定义图片显示格式宏</a></li>
    <li><a href="#使用效果">使用效果</a></li>
  </ul>
</nav></div>
</aside>
        </div>
        <div class="btn">
    <div class="btn-menu" id="btn-menu">
        <i class="iconfont icon-grid-sharp"></i>
    </div>
    <div class="btn-toggle-mode">
        <i class="iconfont icon-contrast-sharp"></i>
    </div>
    <div class="btn-scroll-top">
        <i class="iconfont icon-chevron-up-circle-sharp"></i>
    </div>
</div>
<aside class="sidebar-mobile" style="display: none;">
  <div class="sidebar-wrapper">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archives</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/search/">Search</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
            <li>
                <a href="https://github.com/hllu" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://space.bilibili.com" target="_blank"><span>bilibili</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
            <span>
                <a href="/tags/abbrev/">abbrev</a>
            </span>
            
            <span>
                <a href="/tags/beamer/">beamer</a>
            </span>
            
            <span>
                <a href="/tags/blog/">Blog</a>
            </span>
            
            <span>
                <a href="/tags/curl/">curl</a>
            </span>
            
            <span>
                <a href="/tags/download/">download</a>
            </span>
            
            <span>
                <a href="/tags/emacs/">emacs</a>
            </span>
            
            <span>
                <a href="/tags/http/">http</a>
            </span>
            
            <span>
                <a href="/tags/image/">image</a>
            </span>
            
            <span>
                <a href="/tags/odl/">odl</a>
            </span>
            
            <span>
                <a href="/tags/openstack/">openstack</a>
            </span>
            
            <span>
                <a href="/tags/org/">org</a>
            </span>
            
            <span>
                <a href="/tags/org-model/">org-model</a>
            </span>
            
            <span>
                <a href="/tags/picture/">picture</a>
            </span>
            
            <span>
                <a href="/tags/rpc/">rpc</a>
            </span>
            
            <span>
                <a href="/tags/skeleton/">skeleton</a>
            </span>
            
            <span>
                <a href="/tags/snippet/">snippet</a>
            </span>
            
            <span>
                <a href="/tags/ssh/">ssh</a>
            </span>
            
            <span>
                <a href="/tags/yasnippet/">yasnippet</a>
            </span>
            
            <span>
                <a href="/tags/%E5%8E%8B%E6%B5%8B/">压测</a>
            </span>
            
        </div>
    </div>
    
    
    
    <div class="sidebar-item sidebar-toc">
        <h3>Table of Contents</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#org-download">org-download</a>
      <ul>
        <li><a href="#安装">安装</a></li>
        <li><a href="#配置">配置</a></li>
      </ul>
    </li>
    <li><a href="#inline-images">inline images</a></li>
    <li><a href="#使用yasnippet定义图片显示格式宏">使用yasnippet定义图片显示格式宏</a></li>
    <li><a href="#使用效果">使用效果</a></li>
  </ul>
</nav>
    </div>
    
    
  </div>
</aside>
    </main>

    <footer>
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            
            <span>&copy; 2021-2023
                <a href="https://hllu.github.io">hllu</a>
                 | <a href="https://github.com/hllu/day">Source code</a> 
                | Powered by <a href="https://github.com/dsrkafuu/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> &amp; <a href="https://gohugo.io/"
                                                    target="_blank">Hugo</a> 
            </span>
        </div>
    </div>
</footer>

    
<script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.0/lazysizes.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>



<script defer src="/assets/js/fuji.min.js"></script>


</body>

</html>